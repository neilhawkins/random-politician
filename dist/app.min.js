/*! random-politician - v0.1.0 - 2015-01-07
* Copyright (c) 2015 ;*/var RandoMP={MPs:null,hansard:null,colours:{Conservative:"#0087DC",Labour:"#DC241f","Liberal Democrat":"#FDBB30",DUP:"#D46A4C","Scottish National Party":"#FFFF00","Sinn Fein":"#008800",Independent:"#DDDDDD","Plaid Cymru":"#008142","Social Democratic and Labour Party":"#99FF66",Alliance:"#FFD700",Green:"#6AB023",Respect:"#FF3300",Speaker:"white",UKIP:"#70147A"},getMPs:"http://www.theyworkforyou.com/api/getMPs?key=E5L2aTCuvEZnAXuVfyGN83sM&output=js&callback=?",init:function(a){this.bind_events(),this.make_request(a)},bind_events:function(){var a=this;$(".mp").on("click",function(){$("#last-words").html(""),a.pick_MP()})},lastWords:function(){var a=this.hansard.rows[0].hdate;a=a.replace(/(\d+)-(\d+)-(\d+)/,"$3/$2/$1"),$("#date-spoken").html("<p>Last spoke in parliament on : "+a+"</p>"),$("#last-words").html(this.hansard.rows[0].body)},getHansard:function(a){var b=this;$.getJSON("http://www.theyworkforyou.com/api/getDebates?key=GEGMS7CVRzUFFvoPV2DbcscS&person="+a+"&type=commons&page=1&num=1&output=js&callback=?").done(function(a){b.hansard=a,b.lastWords()})},pick_MP:function(){var a=Math.floor(Math.random()*this.MPs.length),b=this.MPs[a],c=b.person_id,d=b.party;this.MP_id=c,$("#mp-name").text(b.name+" MP").css("color",this.colours[d]),this.getHansard(c)},make_request:function(a){var b=this,c=JSON.parse(localStorage.getItem("MPs"));this.MPs=c,c?this.pick_MP():$.getJSON(a).done(function(a){localStorage.setItem("MPs",JSON.stringify(a)),b.MPs=a,b.pick_MP()})}};$(document).ready(function(){RandoMP.init(RandoMP.getMPs)});